{"version":3,"sources":["webpack:///./src/components/GenSmithKey.vue?a69e","webpack:///./node_modules/querystring-es3/decode.js","webpack:///./src/views/GenSmithKey.vue?40b1","webpack:///./src/components/GenSmithKey.vue?daf5","webpack:///src/components/GenSmithKey.vue","webpack:///./src/components/GenSmithKey.vue?9797","webpack:///./src/components/GenSmithKey.vue?edbb","webpack:///src/views/GenSmithKey.vue","webpack:///./src/views/GenSmithKey.vue?eb40","webpack:///./src/views/GenSmithKey.vue","webpack:///./node_modules/querystring-es3/index.js","webpack:///./node_modules/querystring-es3/encode.js"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_GenSmithKey_vue_vue_type_style_index_0_id_5e8bc98a_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_GenSmithKey_vue_vue_type_style_index_0_id_5e8bc98a_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default","n","hasOwnProperty","obj","prop","Object","prototype","call","module","exports","qs","sep","eq","options","length","regexp","split","maxKeys","len","i","kstr","vstr","k","v","x","replace","idx","indexOf","substr","decodeURIComponent","isArray","push","Array","xs","toString","render","_vm","this","_h","$createElement","_c","_self","staticRenderFns","GenSmithKeyvue_type_template_id_5e8bc98a_scoped_true_render","attrs","fluid","justify-center","ref","id","width","display_size","height","autoplay","on","play","detect_and_draw_faces","style","margin-top","margin_top","xs2","label","model","value","callback","$$v","user_name","expression","xs1","round","color","disabled","detected","click","take_photo_and_upload","_v","xs8","_e","GenSmithKeyvue_type_template_id_5e8bc98a_scoped_true_staticRenderFns","GenSmithKeyvue_type_script_lang_js_","name","components","vueDropzone","vue2Dropzone_default","a","data","dropzoneOptions","url","$API_URL","addRemoveLinks","thumbnailWidth","maxFilesize","maxFiles","detections","undefined","computed","session_id","$store","state","mounted","load_faceapi_models","start_video","find_margin","methods","String","navigator","getUserMedia","video","stream","srcObject","err","console","error","Promise","all","es6","tinyFaceDetector","loadFromUri","faceLandmark68Net","faceExpressionNet","then","log","self","setInterval","asyncToGenerator","regeneratorRuntime","mark","_callee","resizedDetections","wrap","_context","prev","next","$refs","withFaceLandmarks","sent","draw_face_box","canvas","getContext","clearRect","stop","refresh_time","box","detection","box_X_flipped","y","boxOptions","lineWidth","boxColor","drawBox","DrawBox","draw","_canvas","canvas_capture","context","drawImage","face_location","top","right","bottom","left","toBlob","_ref2","_callee2","blob","formData","_context2","FormData","append","axios","method","response","json_file","JSON","stringify","Blob","type","FileSaver_min_default","saveAs","location","reload","_x","apply","arguments","upload_photo","file","xhr","remove_file","myVueDropzone","dropzone","components_GenSmithKeyvue_type_script_lang_js_","component","componentNormalizer","GenSmithKey","views_GenSmithKeyvue_type_script_lang_js_","src_views_GenSmithKeyvue_type_script_lang_js_","GenSmithKey_component","__webpack_exports__","decode","parse","encode","stringifyPrimitive","isFinite","map","objectKeys","ks","encodeURIComponent","join","f","res","keys","key"],"mappings":"kHAAA,IAAAA,EAAAC,EAAA,QAAAC,EAAAD,EAAAE,EAAAH,GAAueE,EAAG,uCC0B1e,SAAAE,EAAAC,EAAAC,GACA,OAAAC,OAAAC,UAAAJ,eAAAK,KAAAJ,EAAAC,GAGAI,EAAAC,QAAA,SAAAC,EAAAC,EAAAC,EAAAC,GACAF,KAAA,IACAC,KAAA,IACA,IAAAT,EAAA,GAEA,qBAAAO,GAAA,IAAAA,EAAAI,OACA,OAAAX,EAGA,IAAAY,EAAA,MACAL,IAAAM,MAAAL,GAEA,IAAAM,EAAA,IACAJ,GAAA,kBAAAA,EAAAI,UACAA,EAAAJ,EAAAI,SAGA,IAAAC,EAAAR,EAAAI,OAEAG,EAAA,GAAAC,EAAAD,IACAC,EAAAD,GAGA,QAAAE,EAAA,EAAiBA,EAAAD,IAASC,EAAA,CAC1B,IAEAC,EAAAC,EAAAC,EAAAC,EAFAC,EAAAd,EAAAS,GAAAM,QAAAV,EAAA,OACAW,EAAAF,EAAAG,QAAAf,GAGAc,GAAA,GACAN,EAAAI,EAAAI,OAAA,EAAAF,GACAL,EAAAG,EAAAI,OAAAF,EAAA,KAEAN,EAAAI,EACAH,EAAA,IAGAC,EAAAO,mBAAAT,GACAG,EAAAM,mBAAAR,GAEAnB,EAAAC,EAAAmB,GAEKQ,EAAA3B,EAAAmB,IACLnB,EAAAmB,GAAAS,KAAAR,GAEApB,EAAAmB,GAAA,CAAAnB,EAAAmB,GAAAC,GAJApB,EAAAmB,GAAAC,EAQA,OAAApB,GAGA,IAAA2B,EAAAE,MAAAF,SAAA,SAAAG,GACA,yBAAA5B,OAAAC,UAAA4B,SAAA3B,KAAA0B,gDClFA,IAAAE,EAAA,WAA0B,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAAA,EAAA,oBACzFE,EAAA,GCDIC,EAAM,WAAgB,IAAAP,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAAA,EAAA,eAAmCI,MAAA,CAAOC,MAAA,KAAY,CAAAL,EAAA,YAAiBI,MAAA,CAAOE,iBAAA,KAAqB,CAAAN,EAAA,SAAcO,IAAA,QAAAH,MAAA,CAAmBI,GAAA,QAAAC,MAAAb,EAAAc,aAAAD,MAAAE,OAAAf,EAAAc,aAAAC,OAAAC,SAAA,IAA2FC,GAAA,CAAKC,KAAAlB,EAAAmB,yBAAkCf,EAAA,UAAeO,IAAA,SAAAH,MAAA,CAAoBI,GAAA,SAAAC,MAAAb,EAAAc,aAAAD,MAAAE,OAAAf,EAAAc,aAAAC,UAA+EX,EAAA,UAAeO,IAAA,iBAAAH,MAAA,CAA4BI,GAAA,iBAAAC,MAAAb,EAAAc,aAAAD,MAAAE,OAAAf,EAAAc,aAAAC,YAAuFX,EAAA,YAAmBgB,MAAA,CAAQC,aAAArB,EAAAsB,cAA+BlB,EAAA,YAAiBI,MAAA,CAAOE,iBAAA,KAAqB,CAAAN,EAAA,UAAeI,MAAA,CAAOe,IAAA,KAAU,CAAAnB,EAAA,gBAAqBI,MAAA,CAAOgB,MAAA,mBAA0BC,MAAA,CAAQC,MAAA1B,EAAA,UAAA2B,SAAA,SAAAC,GAA+C5B,EAAA6B,UAAAD,GAAkBE,WAAA,gBAAyB,GAAA1B,EAAA,UAAmBI,MAAA,CAAOuB,IAAA,KAAU,CAAA3B,EAAA,SAAcI,MAAA,CAAOwB,MAAA,GAAAC,MAAA,UAAAC,UAAAlC,EAAAmC,UAAA,KAAAnC,EAAA6B,WAA6EZ,GAAA,CAAKmB,MAAApC,EAAAqC,wBAAmC,CAAAjC,EAAA,UAAAJ,EAAAsC,GAAA,gBAAAtC,EAAAsC,GAAA,oCAAAlC,EAAA,YAAgGI,MAAA,CAAOE,iBAAA,KAAqB,CAAAN,EAAA,UAAeI,MAAA,CAAO+B,IAAA,KAAU,CAAobvC,EAAAwC,MAAA,gBAC5mDC,EAAe,yICsEnBC,EAAA,CACAC,KAAA,kBACAC,WAAA,CAKAC,YAAAC,EAAAC,GAEAC,KAAA,WACA,OAEAC,gBAAA,CACAC,IAAAjD,KAAAkD,SAAA,sBACAC,gBAAA,EACAC,eAAA,IACAC,YAAA,GACAC,SAAA,GAEAzC,aAAA,CAAAD,MAAA,IAAAE,OAAA,KACAO,WAAA,MACAkC,gBAAAC,EACA5B,UAAA,KAGA6B,SAAA,CACAvB,SAAA,WACA,QAAAlC,KAAAuD,YAOAG,WATA,WAWA,OAAA1D,KAAA2D,OAAAC,MAAAF,aAGAG,QAAA,WACA7D,KAAA8D,sBACA9D,KAAA+D,cACA/D,KAAAgE,eAEAC,QAAA,CACAD,YAAA,WAGAhE,KAAAqB,WAAA6C,OAAAlE,KAAAa,aAAAC,OAAA,UAEAiD,YAAA,WACAI,UAAAC,aACA,CAAAC,MAAA,IACA,SAAAC,GAAA,OAAAD,MAAAE,UAAAD,GACA,SAAAE,GAAA,OAAAC,QAAAC,MAAAF,MAGAV,oBAAA,WAGAa,QAAAC,IAAA,CACAC,EAAA,KAAAC,iBAAAC,YAAA,WACAF,EAAA,KAAAG,kBAAAD,YAAA,WACAF,EAAA,KAAAI,kBAAAF,YAAA,aACAG,KAAAT,QAAAU,IAAA,kBAEAjE,sBAAA,WACAuD,QAAAU,IAAA,yBAIA,IAAAC,EAAApF,KAEAqF,YAAMrH,OAAAsH,EAAA,KAAAtH,CAANuH,mBAAAC,KAAA,SAAAC,IAAA,IAAAC,EAAA,OAAAH,mBAAAI,KAAA,SAAAC,GAAA,eAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EAGAjB,EAAA,KAEAO,EAAAW,MAAA1B,MACA,IAAAQ,EAAA,MAEAmB,oBARA,OAGAZ,EAAA7B,WAHAqC,EAAAK,KAUAb,EAAAlD,UAEAwD,EAAAb,EAAA,KACAO,EAAA7B,WACA6B,EAAAvE,cAIAuE,EAAA7B,WAAAmC,EACAN,EAAAc,iBAKAd,EAAAW,MAAAI,OAAAC,WAAA,MAAAC,UAAA,IAAAF,OAAAvF,MAAAuF,OAAArF,QAxBA,wBAAA8E,EAAAU,SAAAb,MA2BAL,EAAAmB,eAEAL,cAAA,WACA,IAAAC,EAAAnG,KAAA+F,MAAAI,OACAA,EAAAC,WAAA,MAAAC,UAAA,IAAAF,EAAAvF,MAAAuF,EAAArF,QAGA,IAAA0F,EAAAxG,KAAAuD,WAAAkD,UAAAD,IAEAE,EAAA,CACAvH,EAAAgH,EAAAvF,MAAA4F,EAAArH,EAAAqH,EAAA5F,MACA+F,EAAAH,EAAAG,EACA/F,MAAA4F,EAAA5F,MACAE,OAAA0F,EAAA1F,QAGAS,EAAA,qCACA,KAAAvB,KAAA4B,YACAL,EAAA,SAAAvB,KAAA4B,UAAA,sCAEA,IAAAgF,EAAA,CACArF,QACAsF,UAAA,EACAC,SAAA,uBAGAC,EAAA,IAAAlC,EAAA,KAAAmC,QAAAN,EAAAE,GACAG,EAAAE,KAAAd,IAEA/D,sBAAA,WAEA,IAAAgD,EAAApF,KACA,GAAAoF,EAAAlD,SAAA,CAEA,IAAAgF,EAAA9B,EAAAW,MAAAoB,eACAC,EAAAF,EAAAd,WAAA,MACAgB,EAAAf,UAAA,IAAAa,EAAAtG,MAAAsG,EAAApG,QACA,IAAA0F,EAAApB,EAAA7B,WAAAkD,UAAAD,IAEAA,EAAA5F,MAIAwG,EAAAC,UACAjC,EAAAW,MAAA1B,MACAmC,EAAArH,EACAqH,EAAAG,EACAH,EAAA5F,MACA4F,EAAA1F,OACA0F,EAAArH,EACAqH,EAAAG,EACAH,EAAA5F,MACA4F,EAAA1F,QAKA,IAAAwG,EAAA,CAAAd,EAAAe,IAAAf,EAAAgB,MAAAhB,EAAAiB,OAAAjB,EAAAkB,MAIAtC,EAAAW,MAAAoB,eAAAQ,OAAA,eAAAC,EAAA5J,OAAAsH,EAAA,KAAAtH,CAAAuH,mBAAAC,KAAA,SAAAqC,EAAAC,GAAA,IAAAC,EAAA,OAAAxC,mBAAAI,KAAA,SAAAqC,GAAA,eAAAA,EAAAnC,KAAAmC,EAAAlC,MAAA,OAGAiC,EAAA,IAAAE,SAEAF,EAAAG,OACA,OACAJ,EACA,kBAEAC,EAAAG,OACA,YACA9C,EAAAxD,WAEAmG,EAAAG,OAAA,aAAA9C,EAAA1B,YACAqE,EAAAG,OAAA,gBAAAZ,GAEAlC,EAAA+C,MAAA,CACAlF,IAAAmC,EAAAlC,SAAA,sBACAkF,OAAA,OACArF,KAAAgF,IACA7C,KAAA,SAAAmD,GACA5D,QAAAU,IAAA,0BACA,IAAAmD,EAAAC,KAAAC,UAAAH,EAAAtF,MACA+E,EAAA,IAAAW,KAAA,CAAAH,GAAA,CAAAI,KAAA,qBACAC,EAAA7F,EAAA8F,OAAAd,EAAA1C,EAAAxD,UAAA,UAEAiH,SAAAC,WA3BA,wBAAAd,EAAA1B,SAAAuB,MAAA,gBAAAkB,GAAA,OAAAnB,EAAAoB,MAAAhJ,KAAAiJ,YAAA,MAgCAC,aAAA,SAAAC,EAAAC,EAAArB,GACAA,EAAAG,OAAA,aAAAlI,KAAA0D,YACAqE,EAAAG,OACA,YACAlI,KAAA4B,YAGAyH,YAAA,SAAAF,IAGA,IAAAnJ,KAAA+F,MAAAuD,cAAAC,SAAAtH,WACAwC,QAAAU,IAAA,eACAnF,KAAAmI,MAAA,CACAlF,IAAAjD,KAAAkD,SAAA,sBACAkF,OAAA,OACArF,KAAA,CACAsG,YAAAF,EAAA,WAEAjE,KAAA,SAAAmD,UC1RqVmB,EAAA,0BCQrVC,EAAgBzL,OAAA0L,EAAA,KAAA1L,CACdwL,EACAlJ,EACAkC,GACF,EACA,KACA,WACA,MAIemH,EAAAF,UCPfG,EAAA,CACAlH,KAAA,OACAC,WAAA,CACAgH,eAEA9F,QAAA,aAEAI,QAAA,ICnBqV4F,EAAA,ECOjVC,EAAY9L,OAAA0L,EAAA,KAAA1L,CACd6L,EACA/J,EACAO,GACF,EACA,KACA,KACA,MAIe0J,EAAA,WAAAD,oEChBf1L,EAAA4L,OAAA5L,EAAA6L,MAAiCvM,EAAQ,QACzCU,EAAA8L,OAAA9L,EAAAoK,UAAqC9K,EAAQ,2CCoB7C,IAAAyM,EAAA,SAAAjL,GACA,cAAAA,GACA,aACA,OAAAA,EAEA,cACA,OAAAA,EAAA,eAEA,aACA,OAAAkL,SAAAlL,KAAA,GAEA,QACA,WAIAf,EAAAC,QAAA,SAAAN,EAAAQ,EAAAC,EAAAmE,GAOA,OANApE,KAAA,IACAC,KAAA,IACA,OAAAT,IACAA,OAAA0F,GAGA,kBAAA1F,EACAuM,EAAAC,EAAAxM,GAAA,SAAAmB,GACA,IAAAsL,EAAAC,mBAAAL,EAAAlL,IAAAV,EACA,OAAAkB,EAAA3B,EAAAmB,IACAoL,EAAAvM,EAAAmB,GAAA,SAAAC,GACA,OAAAqL,EAAAC,mBAAAL,EAAAjL,MACSuL,KAAAnM,GAETiM,EAAAC,mBAAAL,EAAArM,EAAAmB,OAEKwL,KAAAnM,GAILoE,EACA8H,mBAAAL,EAAAzH,IAAAnE,EACAiM,mBAAAL,EAAArM,IAFA,IAKA,IAAA2B,EAAAE,MAAAF,SAAA,SAAAG,GACA,yBAAA5B,OAAAC,UAAA4B,SAAA3B,KAAA0B,IAGA,SAAAyK,EAAAzK,EAAA8K,GACA,GAAA9K,EAAAyK,IAAA,OAAAzK,EAAAyK,IAAAK,GAEA,IADA,IAAAC,EAAA,GACA7L,EAAA,EAAiBA,EAAAc,EAAAnB,OAAeK,IAChC6L,EAAAjL,KAAAgL,EAAA9K,EAAAd,OAEA,OAAA6L,EAGA,IAAAL,EAAAtM,OAAA4M,MAAA,SAAA9M,GACA,IAAA6M,EAAA,GACA,QAAAE,KAAA/M,EACAE,OAAAC,UAAAJ,eAAAK,KAAAJ,EAAA+M,IAAAF,EAAAjL,KAAAmL,GAEA,OAAAF","file":"js/chunk-14bffd79.757d2c17.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GenSmithKey.vue?vue&type=style&index=0&id=5e8bc98a&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GenSmithKey.vue?vue&type=style&index=0&id=5e8bc98a&scoped=true&lang=css&\"","// Copyright Joyent, Inc. and other Node contributors.\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a\r\n// copy of this software and associated documentation files (the\r\n// \"Software\"), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to permit\r\n// persons to whom the Software is furnished to do so, subject to the\r\n// following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included\r\n// in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\r\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\r\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\r\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\r\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\r\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n\r\n'use strict';\r\n\r\n// If obj.hasOwnProperty has been overridden, then calling\r\n// obj.hasOwnProperty(prop) will break.\r\n// See: https://github.com/joyent/node/issues/1707\r\nfunction hasOwnProperty(obj, prop) {\r\n  return Object.prototype.hasOwnProperty.call(obj, prop);\r\n}\r\n\r\nmodule.exports = function(qs, sep, eq, options) {\r\n  sep = sep || '&';\r\n  eq = eq || '=';\r\n  var obj = {};\r\n\r\n  if (typeof qs !== 'string' || qs.length === 0) {\r\n    return obj;\r\n  }\r\n\r\n  var regexp = /\\+/g;\r\n  qs = qs.split(sep);\r\n\r\n  var maxKeys = 1000;\r\n  if (options && typeof options.maxKeys === 'number') {\r\n    maxKeys = options.maxKeys;\r\n  }\r\n\r\n  var len = qs.length;\r\n  // maxKeys <= 0 means that we should not limit keys count\r\n  if (maxKeys > 0 && len > maxKeys) {\r\n    len = maxKeys;\r\n  }\r\n\r\n  for (var i = 0; i < len; ++i) {\r\n    var x = qs[i].replace(regexp, '%20'),\r\n        idx = x.indexOf(eq),\r\n        kstr, vstr, k, v;\r\n\r\n    if (idx >= 0) {\r\n      kstr = x.substr(0, idx);\r\n      vstr = x.substr(idx + 1);\r\n    } else {\r\n      kstr = x;\r\n      vstr = '';\r\n    }\r\n\r\n    k = decodeURIComponent(kstr);\r\n    v = decodeURIComponent(vstr);\r\n\r\n    if (!hasOwnProperty(obj, k)) {\r\n      obj[k] = v;\r\n    } else if (isArray(obj[k])) {\r\n      obj[k].push(v);\r\n    } else {\r\n      obj[k] = [obj[k], v];\r\n    }\r\n  }\r\n\r\n  return obj;\r\n};\r\n\r\nvar isArray = Array.isArray || function (xs) {\r\n  return Object.prototype.toString.call(xs) === '[object Array]';\r\n};\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('GenSmithKey')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('v-container',{attrs:{\"fluid\":\"\"}},[_c('v-layout',{attrs:{\"justify-center\":\"\"}},[_c('video',{ref:\"video\",attrs:{\"id\":\"video\",\"width\":_vm.display_size.width,\"height\":_vm.display_size.height,\"autoplay\":\"\"},on:{\"play\":_vm.detect_and_draw_faces}}),_c('canvas',{ref:\"canvas\",attrs:{\"id\":\"canvas\",\"width\":_vm.display_size.width,\"height\":_vm.display_size.height}}),_c('canvas',{ref:\"canvas_capture\",attrs:{\"id\":\"canvas_capture\",\"width\":_vm.display_size.width,\"height\":_vm.display_size.height}})]),_c('v-layout',{style:({'margin-top': _vm.margin_top})}),_c('v-layout',{attrs:{\"justify-center\":\"\"}},[_c('v-flex',{attrs:{\"xs2\":\"\"}},[_c('v-text-field',{attrs:{\"label\":\"Your name here:\"},model:{value:(_vm.user_name),callback:function ($$v) {_vm.user_name=$$v},expression:\"user_name\"}})],1),_c('v-flex',{attrs:{\"xs1\":\"\"}},[_c('v-btn',{attrs:{\"round\":\"\",\"color\":\"primary\",\"disabled\":!_vm.detected  || _vm.user_name===''},on:{\"click\":_vm.take_photo_and_upload}},[_c('v-icon',[_vm._v(\"camera_alt\")]),_vm._v(\"Take photo\\n        \")],1)],1)],1),_c('v-layout',{attrs:{\"justify-center\":\"\"}},[_c('v-flex',{attrs:{\"xs8\":\"\"}},[(false)?_c('vueDropzone',{ref:\"myVueDropzone\",attrs:{\"id\":\"myVueDropzone\",\"options\":_vm.dropzoneOptions,\"useCustomSlot\":true},on:{\"vdropzone-sending\":_vm.upload_photo,\"vdropzone-removed-file\":_vm.remove_file}},[_c('div',{staticClass:\"dropzone-custom-content\"},[_c('h3',{staticClass:\"dropzone-custom-title\"},[_vm._v(\"Upload a photo!\")]),_c('div',{staticClass:\"subtitle\"},[_vm._v(\"...or click to select a file from your computer\")])])]):_vm._e()],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <v-container fluid>\n      <v-layout justify-center>\n        <video\n          id=\"video\"\n          ref=\"video\"\n          :width=\"display_size.width\"\n          :height=\"display_size.height\"\n          autoplay\n          @play=\"detect_and_draw_faces\"\n        ></video>\n\n        <canvas id=\"canvas\" ref=\"canvas\" :width=\"display_size.width\" :height=\"display_size.height\"/>\n        <canvas\n          id=\"canvas_capture\"\n          ref=\"canvas_capture\"\n          :width=\"display_size.width\"\n          :height=\"display_size.height\"\n        />\n      </v-layout>\n      <!-- an empty layout to create correct margin for following elements -->\n      <v-layout :style=\"{'margin-top': margin_top}\"/>\n      <v-layout justify-center>\n      <v-flex xs2>\n\n            <v-text-field\n            label=\"Your name here:\"\n            v-model=\"user_name\"\n          ></v-text-field>\n          </v-flex>\n\n        <v-flex xs1>\n          <v-btn round color=\"primary\"  @click=\"take_photo_and_upload\" :disabled=\"!detected  || user_name===''\">\n            <v-icon>camera_alt</v-icon>Take photo\n          </v-btn>\n        </v-flex>\n      </v-layout>\n\n      <v-layout justify-center>\n        <v-flex xs8>\n          <!-- disabled fro now -->\n          <vueDropzone\n            v-if=\"false\"\n            ref=\"myVueDropzone\"\n            id=\"myVueDropzone\"\n            @vdropzone-sending=\"upload_photo\"\n            @vdropzone-removed-file=\"remove_file\"\n            :options=\"dropzoneOptions\"\n            :useCustomSlot=\"true\"\n          >\n            <div class=\"dropzone-custom-content\">\n              <h3 class=\"dropzone-custom-title\">Upload a photo!</h3>\n              <div class=\"subtitle\">...or click to select a file from your computer</div>\n            </div>\n          </vueDropzone>\n        </v-flex>\n      </v-layout>\n    </v-container>\n  </div>\n</template>\n\n<script>\nimport vue2Dropzone from \"vue2-dropzone\";\nimport \"vue2-dropzone/dist/vue2Dropzone.min.css\";\nimport FileSaver from \"file-saver\";\nimport { stringify } from \"querystring\";\nimport * as faceapi from \"face-api.js\";\n\n// import axios from \"axios\";\n\nexport default {\n  name: \"upload_download\",\n  components: {\n    // https://itnext.io/vue-a-pattern-for-idiomatic-performant-component-registration-you-might-not-know-about-9f3c091846f5?gi=4351204c93b8\n    //  https://stackoverflow.com/questions/52038615/in-vue-js-why-do-we-have-to-export-components-after-importing-them\n    // https://alligator.io/vuejs/vue-dropzone/\n    // https://rowanwins.github.io/vue-dropzone/docs/dist/#/events\n    vueDropzone: vue2Dropzone\n  },\n  data: function() {\n    return {\n      // dropzone settings\n      dropzoneOptions: {\n        url: this.$API_URL + \"/generate_smith_key\",\n        addRemoveLinks: true,\n        thumbnailWidth: 150,\n        maxFilesize: 0.5,\n        maxFiles: 1\n      },\n      display_size: { width: 640, height: 480 },\n      margin_top: \"0px\",\n      detections: undefined,\n      user_name: '',\n    };\n  },\n  computed: {\n    detected: function(){\n      if (this.detections){\n        return true\n      }\n      else{\n        return false\n      }\n    },\n    session_id() {\n      // session_id should be sent to all the axios request to backend now\n      return this.$store.state.session_id;\n    }\n  },\n  mounted: function() {\n    this.load_faceapi_models();\n    this.start_video();\n    this.find_margin();\n  },\n  methods: {\n    find_margin: function() {\n      // var box = this.$refs.video.getBoundingClientRect();\n      // this.margin_top = String(box.bottom-box.top) + \"px\";\n      this.margin_top = String(this.display_size.height + 20) + \"px\";\n    },\n    start_video: function() {\n      navigator.getUserMedia(\n        { video: {} },\n        stream => (video.srcObject = stream),\n        err => console.error(err)\n      );\n    },\n    load_faceapi_models: function() {\n      // save the models to the public/models\n      // faceapi.nets.ssdMobilenetv1.loadFromUri(\"/models\"),\n      Promise.all([\n        faceapi.nets.tinyFaceDetector.loadFromUri(\"/models\"),\n        faceapi.nets.faceLandmark68Net.loadFromUri(\"/models\"),\n        faceapi.nets.faceExpressionNet.loadFromUri(\"/models\")\n      ]).then(console.log(\"model loaded\"));\n    },\n    detect_and_draw_faces: function() {\n      console.log(\"start detecting faces\");\n      // https://michaelnthiessen.com/this-is-undefined/\n      // https://stackoverflow.com/questions/47148363/when-to-use-vm-or-this-in-vue-js\n      // arrow function is a pain in vue.js and this async function also seems to cause problem\n      let self = this;\n\n      setInterval(async function() {\n        //  After face detection and facial landmark prediction the face descriptors\n        //  all the results are stored in self.detections\n        self.detections = await faceapi\n          .detectSingleFace(\n            self.$refs.video,\n            new faceapi.TinyFaceDetectorOptions()\n          )\n          .withFaceLandmarks();\n\n        if (self.detected) {\n          // calculated the size that is on our canvas size\n          const resizedDetections = faceapi.resizeResults(\n            self.detections,\n            self.display_size\n          );\n\n          // replace the result with scaled one, all the other information will remain\n          self.detections = resizedDetections;\n          self.draw_face_box();\n        }\n\n        //  clear the canvas if not detected\n       else{\n        self.$refs.canvas.getContext(\"2d\").clearRect(0, 0, canvas.width, canvas.height);\n        }\n\n      }, self.refresh_time);\n    },\n    draw_face_box: function() {\n      const canvas = this.$refs.canvas;\n      canvas.getContext(\"2d\").clearRect(0, 0, canvas.width, canvas.height);\n\n      // Draw box around the face with 1 line text\n      const box = this.detections.detection.box;\n      // mirror X\n      const box_X_flipped = {\n        x: canvas.width - box.x - box.width,\n        y: box.y,\n        width: box.width,\n        height: box.height\n      };\n      // see DrawBoxOptions below\n      var label = 'Hello, Please type your name first'\n      if (this.user_name !== ''){\n        label = \"Hello \" + this.user_name + \"! Press save to generate your key!\"\n      }\n      const boxOptions = {\n        label: label,\n        lineWidth: 4,\n        boxColor: \"rgba(57,255,20,0.8)\"\n      };\n      // flip the x-value x, y, width, height\n      const drawBox = new faceapi.draw.DrawBox(box_X_flipped, boxOptions);\n      drawBox.draw(canvas);\n    },\n    take_photo_and_upload: function() {\n      // https://x-team.com/blog/webcam-capture-vue/\n      let self = this;\n      if (self.detected) {\n        // keep track how many images we have captured\n        const canvas = self.$refs.canvas_capture;\n        var context = canvas.getContext(\"2d\");\n        context.clearRect(0, 0, canvas.width, canvas.height);\n        var box = self.detections.detection.box;\n        // giving some padding so we dont crop too much which gives problem to backend\n        var pad = 0.2 * box.width;\n        // drawImage from the video stream, with cropping\n        // Sending the face with cropped region \n        // drawImage from the video stream, with cropping\n        context.drawImage(\n          self.$refs.video,\n          box.x,\n          box.y,\n          box.width,\n          box.height,\n          box.x,\n          box.y,\n          box.width,\n          box.height\n        );\n\n        // sending the face_location to backend to save some repetition \n        // top, right, bottom, left\n        const face_location = [box.top, box.right, box.bottom, box.left]\n\n\n        // Saving canvas to local drive is easy: https://github.com/eligrey/FileSaver.js/\n        self.$refs.canvas_capture.toBlob(async function(blob) {\n          // upload Blob as a form to the flask backend and generate descriptors\n          // https://github.com/pagekit/vue-resource/blob/master/docs/recipes.md\n          let formData = new FormData();\n          // formData.append(name, value, filename);\n          formData.append(\n            \"file\",\n            blob,\n            \"known_face.jpg\"\n          );\n          formData.append(\n            \"user_name\",\n            self.user_name\n          )\n          formData.append(\"session_id\", self.session_id);\n          formData.append(\"face_location\", face_location);\n\n          self.axios({\n            url: self.$API_URL + \"/generate_smith_key\",\n            method: \"POST\",\n            data: formData\n          }).then(response=>{\n            console.log('downloading .smith key')\n            const json_file = JSON.stringify(response.data);\n            var blob = new Blob([json_file], { type: \"application/json\" });\n            FileSaver.saveAs(blob, self.user_name + \".smith\");\n            // refresh the page\n            location.reload();\n          });\n        });\n      }\n    },\n    upload_photo: function(file, xhr, formData) {\n      formData.append(\"session_id\", this.session_id);\n        formData.append(\n            \"user_name\",\n            this.user_name\n          )\n    },\n    remove_file: function(file) {\n      // https://alligator.io/vuejs/rest-api-axios/\n      // https://github.com/rowanwins/vue-dropzone/issues/85\n      if (this.$refs.myVueDropzone.dropzone.disabled !== true) {\n        console.log(\"remove file\");\n        this.axios({\n          url: this.$API_URL + \"/generate_smith_key\",\n          method: \"POST\",\n          data: {\n            remove_file: file[\"name\"]\n          }\n        }).then(response => {});\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n@import url(\"https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css\");\n\n#video {\n  /* position: absolute; */\n  /* flip the image so it is more natural */\n  position: absolute;\n  transform: scaleX(-1);\n  z-index: 1;\n}\n\n#canvas {\n  position: absolute;\n  pointer-events: none;\n  z-index: 2;\n  /* transform: scaleX(-1); */\n}\n\n#canvas_capture {\n  /* we dont need to see it */\n  position: absolute;\n  display: none;\n  z-index: 3;\n  transform: scaleX(-1);\n}\n\n#myVueDropzone {\n  position: relative;\n  z-index: 0;\n}\n\n.dropzone-custom-title {\n  /* margin-top: 0; */\n  color: #00b782;\n}\n\n.subtitle {\n  color: #314b5f;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GenSmithKey.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GenSmithKey.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./GenSmithKey.vue?vue&type=template&id=5e8bc98a&scoped=true&\"\nimport script from \"./GenSmithKey.vue?vue&type=script&lang=js&\"\nexport * from \"./GenSmithKey.vue?vue&type=script&lang=js&\"\nimport style0 from \"./GenSmithKey.vue?vue&type=style&index=0&id=5e8bc98a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5e8bc98a\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div>\n\n    <GenSmithKey/>\n\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport GenSmithKey from \"@/components/GenSmithKey.vue\";\n\nexport default {\n  name: \"face\",\n  components: {\n    GenSmithKey\n  },\n  mounted: function(){\n  },\n  methods: {\n    \n  },\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GenSmithKey.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GenSmithKey.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./GenSmithKey.vue?vue&type=template&id=c0614eb0&\"\nimport script from \"./GenSmithKey.vue?vue&type=script&lang=js&\"\nexport * from \"./GenSmithKey.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","'use strict';\r\n\r\nexports.decode = exports.parse = require('./decode');\r\nexports.encode = exports.stringify = require('./encode');\r\n","// Copyright Joyent, Inc. and other Node contributors.\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a\r\n// copy of this software and associated documentation files (the\r\n// \"Software\"), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to permit\r\n// persons to whom the Software is furnished to do so, subject to the\r\n// following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included\r\n// in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\r\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\r\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\r\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\r\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\r\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n\r\n'use strict';\r\n\r\nvar stringifyPrimitive = function(v) {\r\n  switch (typeof v) {\r\n    case 'string':\r\n      return v;\r\n\r\n    case 'boolean':\r\n      return v ? 'true' : 'false';\r\n\r\n    case 'number':\r\n      return isFinite(v) ? v : '';\r\n\r\n    default:\r\n      return '';\r\n  }\r\n};\r\n\r\nmodule.exports = function(obj, sep, eq, name) {\r\n  sep = sep || '&';\r\n  eq = eq || '=';\r\n  if (obj === null) {\r\n    obj = undefined;\r\n  }\r\n\r\n  if (typeof obj === 'object') {\r\n    return map(objectKeys(obj), function(k) {\r\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\r\n      if (isArray(obj[k])) {\r\n        return map(obj[k], function(v) {\r\n          return ks + encodeURIComponent(stringifyPrimitive(v));\r\n        }).join(sep);\r\n      } else {\r\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\r\n      }\r\n    }).join(sep);\r\n\r\n  }\r\n\r\n  if (!name) return '';\r\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\r\n         encodeURIComponent(stringifyPrimitive(obj));\r\n};\r\n\r\nvar isArray = Array.isArray || function (xs) {\r\n  return Object.prototype.toString.call(xs) === '[object Array]';\r\n};\r\n\r\nfunction map (xs, f) {\r\n  if (xs.map) return xs.map(f);\r\n  var res = [];\r\n  for (var i = 0; i < xs.length; i++) {\r\n    res.push(f(xs[i], i));\r\n  }\r\n  return res;\r\n}\r\n\r\nvar objectKeys = Object.keys || function (obj) {\r\n  var res = [];\r\n  for (var key in obj) {\r\n    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);\r\n  }\r\n  return res;\r\n};\r\n"],"sourceRoot":""}